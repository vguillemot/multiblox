---
title: "ISTA pour la régression de Cox"
author: "Vincent Guillemot et Cathy Philippe"
date: "25/02/2015"
output: pdf_document
header-includes: \newcommand{\prox}{\text{prox}}
---

Le problème de la régression de Cox  de $X$ sur $y$ avec une pénalité $\ell_1$ se formule de la manière suivante :

\[
  \min_{\beta} \left\{ - \ell(X,y,\beta) + \alpha \|\beta\|_1 \right\},
\]
avec $\ell$ la fonction de vraisemblance partielle du modèle de Cox. La vraisemblance devant être maximisée, nous la faisons précéder du signe moins pour transformer le problème en un problème de minimisation.

# Principe

Comme pour la régression multiple, le principe de cette méthode est de calculer à chaque itération la mise à jour du vecteur des poids de la manière suivante :
\[
  \beta^{k+1} \leftarrow \prox_{t \lambda \|\cdot\|_1} \left(  \beta^k - t \nabla_\ell (\beta^k) \right),
\]
avec

* $\nabla_\ell (\beta) = ???$,
* $t = ???$,
* $\prox_{t \alpha \|\cdot\|_1}$ est l'opérateur proximal de la norm $\ell_1$ multiplié par $t \lambda$.

# Implémentation en R

Nous proposons d'implémenter en R cet algorithme. Il faut tout d'abord déclarer les fonctions permettant de calculer le gradient de la fonction de perte et l'opérateur proximal.

```{r definitions}
grad <- function(X,y,beta) print("???")
prox <- function(beta,t,alpha) ifelse(abs(beta)<t*alpha,0,beta-t*alpha*sign(beta))
```

Ces fonctions étant définies, nous pouvons implémenter l'algorithme ISTA.

```{r ista}
ista <- function(X, y, alpha, kmax=100, epsilon=1e-10) {
  p <- ncol(X)
  n <- nrow(X)
  betaold <- rnorm(p)
  t <- 1/max(eigen(t(X)%*%X)$values)
  
  for (k in 1:kmax) {
    betanew <- prox(betaold - t*grad(X,y,betaold),t,alpha)
    if ( sum((betanew-betaold)**2) < epsilon ) break
    betaold <- betanew
  }
  
  return(list(beta=betanew, k=k))
}
```

# Test sur données simulées
